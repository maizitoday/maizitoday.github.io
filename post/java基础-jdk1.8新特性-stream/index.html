<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="http://maizitoday.github.io//img/home-bg-jeep.jpg">
    <meta property="twitter:image" content="http://maizitoday.github.io//img/home-bg-jeep.jpg" />
    

    
    <meta name="title" content="jdk1.8新特性-stream" />
    <meta property="og:title" content="jdk1.8新特性-stream" />
    <meta property="twitter:title" content="jdk1.8新特性-stream" />
    

    
    <meta name="description" content="麦子，程序员, 开源爱好者，生活探险家 | 这里是 麦子 的博客，与你一起发现更大的世界。">
    <meta property="og:description" content="麦子，程序员, 开源爱好者，生活探险家 | 这里是 麦子 的博客，与你一起发现更大的世界。" />
    <meta property="twitter:description" content="麦子，程序员, 开源爱好者，生活探险家 | 这里是 麦子 的博客，与你一起发现更大的世界。" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="麦子, maizi, maizi, , 麦子的网络日志, 麦子的博客, maizi Blog, 博客, 个人网站, 互联网, Web, 云原生, PaaS, Istio, Kubernetes, 微服务, Microservice">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>jdk1.8新特性-stream-麦子的博客</title>

    <link rel="canonical" href="/post/java%E5%9F%BA%E7%A1%80-jdk1.8%E6%96%B0%E7%89%B9%E6%80%A7-stream/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/syntax.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>
	
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/docco.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>


<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"></a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/categories/life">Life</a>
                    </li>
                    
                    <li>
                        <a href="/categories/tech">Tech</a>
                    </li>
                    
                    
		    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
		    <li>
                        <a href="/search">SEARCH <img src="/img/search.png" height="15" style="cursor: pointer;" alt="Search"></a>
		    </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('https://zhaohuabing.com//img/post-bg-unix-linux.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/java%E5%9F%BA%E7%A1%80" title="java基础">
                            java基础
                        </a>
                        
                        <a class="tag" href="/tags/stream" title="stream">
                            stream
                        </a>
                        
                    </div>
                    <h1>jdk1.8新特性-stream</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
			Posted by 
			
			         &#34;麦子&#34;
			 
			on 
			Tuesday, July 2, 2019
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
<ul>
<li><a href="#为什么需要-stream">为什么需要 Stream</a></li>
<li><a href="#构造流的几种常见方法">构造流的几种常见方法</a>
<ul>
<li><a href="#数值流的构造">数值流的构造</a></li>
</ul></li>
<li><a href="#流转换为其它数据结构">流转换为其它数据结构</a></li>
<li><a href="#流的操作">流的操作</a>
<ul>
<li><a href="#intermediate-中间操作">Intermediate(中间操作)</a>
<ul>
<li><a href="#常用方法">常用方法</a>
<ul>
<li><a href="#筛选与切片">筛选与切片</a></li>
<li><a href="#映射">映射</a></li>
<li><a href="#排序">排序</a></li>
</ul></li>
</ul></li>
<li><a href="#terminal-最终操作">Terminal(最终操作)</a>
<ul>
<li><a href="#常用方法-1">常用方法</a>
<ul>
<li><a href="#查找与匹配">查找与匹配</a></li>
<li><a href="#归约">归约</a></li>
<li><a href="#收集">收集</a></li>
</ul></li>
</ul></li>
<li><a href="#short-circuiting-环形">short-circuiting(环形)</a>
<ul>
<li><a href="#常用方法-2">常用方法</a></li>
</ul></li>
</ul></li>
<li><a href="#常用实例代码">常用实例代码</a>
<ul>
<li><a href="#intermediate-中间操作-1">Intermediate(中间操作)</a></li>
<li><a href="#terminal-最终操作-1">Terminal(最终操作)</a>
<ul>
<li><a href="#集合常用方法">集合常用方法</a></li>
</ul></li>
</ul></li>
<li><a href="#注意">注意</a></li>
<li><a href="#stream-的特性可以归纳">Stream 的特性可以归纳</a></li>
</ul>
</nav>
                
                

<p>[TOC]</p>

<p><strong>转载地址：<a href="https://blog.csdn.net/Young4Dream/article/details/76794659">https://blog.csdn.net/Young4Dream/article/details/76794659</a></strong></p>

<p><strong>转载地址：<a href="https://blog.csdn.net/chenhao_c_h/article/details/80691284">https://blog.csdn.net/chenhao_c_h/article/details/80691284</a></strong></p>

<p><strong>转载地址:  <a href="https://blog.csdn.net/Keith003/article/details/80252553">https://blog.csdn.net/Keith003/article/details/80252553</a></strong></p>

<h1 id="为什么需要-stream">为什么需要 Stream</h1>

<p>它专注于对集合对象进行各种非常便利、高效的聚合操作（aggregate operation），或者大批量数据操作 (bulk data operation)。Stream API 借助于同样新出现的 Lambda 表达式，极大的提高编程效率和程序可读性。同时它提供串行和并行两种模式进行汇聚操作，并发模式能够充分利用多核处理器的优势，使用 fork/join 并行方式来拆分任务和加速处理过程。通常编写并行代码很难而且容易出错, 但使用 Stream API 无需编写一行多线程的代码，就可以很方便地写出高性能的并发程序。所以说，Java 8 中首次出现的 java.util.stream 是一个函数式语言+多核时代综合影响的产物。</p>

<p><strong>Stream 不是集合元素，它不是数据结构并不保存数据，它是有关算法和计算的，它更像一个高级版本的 Iterator。</strong></p>

<p>Stream 就如同一个迭代器（Iterator），单向，不可往复，数据只能遍历一次，遍历过一次后即用尽了，就好比流水从面前流过，一去不复返。</p>

<p>而和迭代器又不同的是，Stream 可以并行化操作，迭代器只能命令式地、串行化操作。顾名思义，当使用串行方式去遍历时，每个 item 读完后再读下一个 item。而使用并行去遍历时，数据会被分成多个段，其中每一个都在不同的线程中处理，然后将结果一起输出。</p>

<p><strong>Stream 的另外一大特点是，数据源本身可以是无限的。</strong></p>

<h1 id="构造流的几种常见方法">构造流的几种常见方法</h1>

<pre><code class="language-java">// 字符 
Stream stream = Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);

// 数组
String [] strArray = new String[] {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;};
stream = Stream.of(strArray);
stream = Arrays.stream(strArray);

// 集合
List&lt;String&gt; list = Arrays.asList(strArray);
stream = list.stream();
</code></pre>

<h2 id="数值流的构造">数值流的构造</h2>

<p>需要注意的是，对于基本数值型，目前有三种对应的包装类型 Stream：IntStream、LongStream、DoubleStream<code>。当然我们也可以用</code>Stream<Integer>、Stream<Long> &gt;、Stream<Double>`，</p>

<pre><code class="language-java">IntStream.of(new int[]{1, 2, 3}).forEach(System.out::println);
IntStream.range(1, 3).forEach(System.out::println);
IntStream.rangeClosed(1, 3).forEach(System.out::println);
</code></pre>

<h1 id="流转换为其它数据结构">流转换为其它数据结构</h1>

<pre><code class="language-java">// 1. Array
String[] strArray1 = stream.toArray(String[]::new);

// list
List&lt;String&gt; list1 = stream.collect(Collectors.toList());
List&lt;String&gt; list2 = stream.collect(Collectors.toCollection(ArrayList::new));

// Set
Set set1 = stream.collect(Collectors.toSet());
Stack stack1 = stream.collect(Collectors.toCollection(Stack::new));

// 3. String
String str = stream.collect(Collectors.joining()).toString();
</code></pre>

<h1 id="流的操作">流的操作</h1>

<h2 id="intermediate-中间操作">Intermediate(中间操作)</h2>

<p>一个流可以后面跟随零个或多个 intermediate 操作。其目的主要是打开流，做出某种程度的数据映射/过滤，然后返回一个新的流，交给下一个操作使用。<strong>这类操作都是惰性化的（lazy），就是说，仅仅调用到这类方法，并没有真正开始流的遍历。</strong></p>

<p>多个中间操作可以连接起来形成一个流水线，除非流水线上触发终止操作，否则中间操作不会执行任何的处理！而在终止操作时一次性全部处理，<strong>称为“惰性求值”。</strong></p>

<h3 id="常用方法">常用方法</h3>

<p>map (mapToInt, flatMap 等)、 filter、 distinct、 sorted、 peek、 limit、 skip、 parallel、 sequential、 unordered</p>

<h4 id="筛选与切片">筛选与切片</h4>

<p><img src="/img/20180509140419898.png" alt="20180509140419898" /></p>

<h4 id="映射">映射</h4>

<p><img src="/img/20180509140353794.png" alt="20180509140353794" /></p>

<h4 id="排序">排序</h4>

<p><img src="/img/20180509140320474.png" alt="20180509140320474" /></p>

<h2 id="terminal-最终操作">Terminal(最终操作)</h2>

<p>一个流只能有一个 terminal 操作，当这个操作执行后，流就被使用“光”了，无法再被操作。所以这必定是流的最后一个操作。Terminal 操作的执行，才会真正开始流的遍历，并且会生成一个结果，或者一个 side effect。</p>

<h3 id="常用方法-1">常用方法</h3>

<p>forEach、 forEachOrdered、 toArray、 reduce、 collect、 min、 max、 count、 anyMatch、 allMatch、 noneMatch、 findFirst、 findAny、 iterator</p>

<h4 id="查找与匹配">查找与匹配</h4>

<p><img src="/img/20180509140624786.png" alt="20180509140624786" /></p>

<p><img src="/img/20180509140651964.png" alt="20180509140651964" /></p>

<h4 id="归约">归约</h4>

<p><img src="/img/20180509140732558.png" alt="20180509140732558" /></p>

<p><strong>注：map 和 reduce 的连接通常称为map-reduce 模式，因 Google 用它来进行网络搜索而出名</strong></p>

<h4 id="收集">收集</h4>

<p><img src="/img/20180509140941161.png" alt="20180509140941161" /></p>

<p>Collector 接口中方法的实现决定了如何对流执行收集操作(如收集到List、Set、Map)。但是Collectors 实用类提供了很多静态方法，可以方便地创建常见收集器实例，具体方法与实例如下表：</p>

<p><img src="/img/20180509141507583.png" alt="20180509141507583" /></p>

<h2 id="short-circuiting-环形">short-circuiting(环形)</h2>

<ul>
<li>对于一个<strong>intermediate</strong> 操作，如果它接受的是一个无限大（infinite/unbounded）的<strong>Stream</strong>，但返回一个有限的新<strong>Stream</strong>。</li>
<li>对于一个 <strong>terminal</strong> 操作，如果它接受的是一个无限大的 <strong>Stream</strong>，但能在有限的时间计算出结果。</li>
</ul>

<p>当操作一个无限大的 <strong>Stream</strong>，而又希望在有限时间内完成操作，则在管道内拥有一个 short-circuiting 操作是必要非充分条件。</p>

<h3 id="常用方法-2">常用方法</h3>

<p>anyMatch、 allMatch、 noneMatch、 findFirst、 findAny、 limit</p>

<h1 id="常用实例代码">常用实例代码</h1>

<h2 id="intermediate-中间操作-1">Intermediate(中间操作)</h2>

<pre><code class="language-java">   /**
    对每个元素执行mapper指定的操作，并用所有mapper返回的Stream中的元素组成一个新的Stream作为最终返回结果，通俗易懂就是将原来的stream中的所有元素都展开组成一个新的stream, map 只能对应一维数据， flatMap主要对应的事二维数据，可以看出返回的对象是一个流， 所以可以在对流进行数据处理。
   */ 
    public static void flatMapTest() {
        List&lt;School&gt; childs1 = new ArrayList&lt;School&gt;();
        childs1.add(new School(10, &quot;10号&quot;, &quot;深圳&quot;, &quot;开放&quot;));
        childs1.add(new School(11, &quot;11号&quot;, &quot;湖南&quot;, &quot;建设中&quot;));

        List&lt;School&gt; childs2 = new ArrayList&lt;School&gt;();
        childs2.add(new School(12, &quot;12号&quot;, &quot;邵阳&quot;, &quot;倒闭&quot;));
        childs2.add(new School(13, &quot;13号&quot;, &quot;西乡&quot;, &quot;倒闭&quot;));

        List&lt;School&gt; childs3 = new ArrayList&lt;School&gt;();
        childs3.add(new School(14, &quot;14号&quot;, &quot;保安&quot;, &quot;建设中&quot;));

        List&lt;List&lt;School&gt;&gt; data = new ArrayList&lt;&gt;();
        data.add(childs1);
        data.add(childs2);
        data.add(childs3);

        data.stream().flatMap(temp -&gt; temp.stream().filter(entity -&gt; entity.getId() &gt; 12)).forEach(System.out::println);
        ;

        // 执行结果如下
        // School(id=13, name=13号, address=西乡)
        // School(id=14, name=14号, address=保安)
    }

    // findFirst 获取第一个
    public static void findFirstTest(List&lt;School&gt; schoolList) {
        School school = schoolList.stream().findFirst().get();
        System.out.println(school);
    }

    // 接收一个方法作为参数，该函数会被应用到每个元素上，并将其映射成一个新的元素
    public static void mapTest(List&lt;School&gt; schoolList) {
        Function&lt;School, School&gt; fun = (school) -&gt; {
            String name = school.getName();
            school.setName(name + &quot;---&quot; + school.getId());
            return school;
        };
        schoolList.stream().map(fun).forEach(System.out::println);
    }

    // distinct 去重
    public static void distinctTst(List&lt;School&gt; schoolList) {
        schoolList.stream().distinct().sorted((o1, o2) -&gt; o1.getId() - o2.getId()).forEach(System.out::println);
    }

    // skip 和 limit是互斥的， skip是跳过前面几个， limit是截断， 顺序都是从前面作为起点。
    public static void skipTest(List&lt;School&gt; schoolList) {
        schoolList.stream().skip(2).forEach(System.out::println);
    }

    // 排序
    public static void sortedTest(List&lt;School&gt; schoolList) {
        schoolList.stream().sorted((o1, o2) -&gt; o1.getId() - o2.getId()).forEach(System.out::println);
    }

    // filter
    public static void filterTest(List&lt;School&gt; schoolList) {
        schoolList.stream().filter(school -&gt; school.getId() &gt; 3).forEach(System.out::println);

    }

    // limit
    public static void limitTest(List&lt;School&gt; schoolList) {
        schoolList.stream().limit(2).forEach(System.out::println);
    }


    // max，min，count,sum，avg，
    public static void sqlTest(List&lt;School&gt; schoolList) {
        Optional&lt;School&gt; opt = schoolList.stream().max((o1, o2) -&gt; o1.getId() - o2.getId());
        School school = opt.get();
        System.out.println(school);

        opt = schoolList.stream().min((o1, o2) -&gt; o1.getId() - o2.getId());
        school = opt.get();
        System.out.println(school);

        long count = schoolList.stream().count();
        System.out.println(count);

        double avg = schoolList.stream().collect(Collectors.averagingInt(x -&gt; x.getId()));
        System.out.println(avg);

        double sum = schoolList.stream().collect(Collectors.summingInt(x -&gt; x.getId()));
        System.out.println(sum);
    }
</code></pre>

<h2 id="terminal-最终操作-1">Terminal(最终操作)</h2>

<pre><code class="language-java">    // 归约---可以将流中元素反复结合起来，得到一个值
    // map 和 reduce 的连接通常称为map-reduce 模式，因 Google 用它来进行网络搜索而出名
    public static void reduceTest(List&lt;School&gt; schoolList) {

        schoolList.stream().map(x -&gt; x.getId()).forEach(System.out::println);

        Optional&lt;Integer&gt; op = schoolList.stream().map(x -&gt; x.getId()).reduce((x, y) -&gt; x + y);
        System.out.println(op.get());

        // 相对于一个参数的方法来说，它多了一个T类型的参数；实际上就相当于需要计算的值在Stream的基础上多了一个初始化的值。
        int count = schoolList.stream().map(x -&gt; x.getId()).reduce(2, (x, y) -&gt; x + y);
        System.out.println(count);
    }
</code></pre>

<h3 id="集合常用方法">集合常用方法</h3>

<pre><code class="language-java">
        // 一次性获取 avg， sum 等操作
        DoubleSummaryStatistics doubleSummaryStatistics = schoolList.stream()
                .collect(Collectors.summarizingDouble(School::getId));
        System.out.println(doubleSummaryStatistics.getSum());
        System.out.println(doubleSummaryStatistics.getAverage());
        System.out.println(doubleSummaryStatistics.getMax());
        System.out.println(doubleSummaryStatistics.getMin());
        System.out.println(doubleSummaryStatistics.getCount());

        // 连接
        String str = schoolList.stream().map(School::getName).collect(Collectors.joining(&quot;,&quot;, &quot;$$$&quot;, &quot;###&quot;));
        System.out.println(str);

        List&lt;String&gt; dataIdList = schoolList.stream().map(School::getName).collect(Collectors.toList());
        dataIdList.forEach(System.out::println);
        System.out.println(&quot;-----------------&quot;);

        Set&lt;String&gt; dataSet = schoolList.stream().map(School::getName).collect(Collectors.toSet());
        dataSet.forEach(System.out::println);
        System.out.println(&quot;-----------------&quot;);

        // 这里转换成其他数据结构
        HashSet&lt;String&gt; hashSet = schoolList.stream().map(School::getName)
                .collect(Collectors.toCollection(HashSet::new));
        hashSet.forEach(System.out::println);

        // 总数
        Long count = schoolList.stream().collect(Collectors.counting());
        System.out.println(&quot;总数:&quot; + count);

        // 平均值
        Double avg = schoolList.stream().collect(Collectors.averagingDouble(School::getId));
        System.out.println(&quot;平均值:&quot; + avg);

        // 总和
        Double sum = schoolList.stream().collect(Collectors.summingDouble(School::getId));
        System.out.println(&quot;总和:&quot; + sum);

        // 最大值
        Optional&lt;School&gt; max = schoolList.stream()
                .collect(Collectors.maxBy((x, y) -&gt; Double.compare(x.getId(), y.getId())));
        System.out.println(&quot;最大值&quot; + max.get());

        // 最小值
        Optional&lt;School&gt; min = schoolList.stream()
                .collect(Collectors.minBy((x, y) -&gt; Double.compare(x.getId(), y.getId())));
        System.out.println(&quot;最小值&quot; + min.get());

        // 分组
        Map&lt;String, List&lt;School&gt;&gt; groupData = schoolList.stream().collect(Collectors.groupingBy(x -&gt; x.getStatus()));
        System.out.println(&quot;分组:&quot; + groupData);
        /***
         * 
         * 
         * 分组:{
         * 
         * 倒闭=[School(id=3, name=3号, address=邵阳, status=倒闭), School(id=2, name=2号,
         * address=西乡, status=倒闭)],
         * 
         * 开放=[School(id=0, name=5号, address=深圳, status=开放), School(id=4, name=4号,
         * address=保安, status=开放), School(id=50, name=5号, address=深圳, status=开放)],
         * 
         * 建设中=[School(id=1, name=1号, address=湖南, status=建设中)]
         * 
         * }
         * 
         * 
         * 
         */

        // 多级分组 先按状态分组，在按id分组, 这种分组可以无限分组
        Map&lt;String, Map&lt;String, List&lt;School&gt;&gt;&gt; data = schoolList.stream()
                .collect(Collectors.groupingBy(School::getStatus, Collectors.groupingBy((x) -&gt; {
                    School currentSchool = (School) x;
                    if (currentSchool.getId() &gt; 3) {
                        return &quot;幸运号码&quot;;
                    } else {
                        return &quot;通吃号码&quot;;
                    }

                })));
        System.out.println(&quot;多级分组:&quot; + data);
        /***
         * 
         * {
         * 
         * 倒闭={通吃号码=[School(id=3, name=3号, address=邵阳, status=倒闭), School(id=2, name=2号,
         * address=西乡, status=倒闭)]},
         * 
         * 开放={通吃号码=[School(id=0, name=5号, address=深圳, status=开放)], 幸运号码=[School(id=4,
         * name=4号, address=保安, status=开放), School(id=50, name=5号, address=深圳,
         * status=开放)]},
         * 
         * 建设中={通吃号码=[School(id=1, name=1号, address=湖南, status=建设中)]}
         * 
         * }
         * 
         */

        // 分区
        System.out.println(&quot;分区----------------------------&quot;);
        Map&lt;Boolean, List&lt;School&gt;&gt; map = schoolList.stream().collect(Collectors.partitioningBy((x) -&gt; x.getId() &gt; 4));
        System.out.println(map);
        /**
         * 
         * 
         * {
         * 
         * false=[School(id=0, name=5号, address=深圳, status=开放), School(id=1, name=1号,
         * address=湖南, status=建设中), School(id=3, name=3号, address=邵阳, status=倒闭),
         * School(id=2, name=2号, address=西乡, status=倒闭), School(id=4, name=4号,
         * address=保安, status=开放)],
         * 
         * true=[School(id=50, name=5号, address=深圳, status=开放)] }
         * 
         */

    }
</code></pre>

<h1 id="注意">注意</h1>

<p>在对于一个 Stream 进行多次转换操作 (Intermediate 操作)，每次都对 Stream 的每个元素进行转换，而且是执行多次，这样时间复杂度就是 N（转换次数）个 for 循环里把所有操作都做掉的总和吗？其实不是这样的，转换操作都是 lazy 的，多个转换操作只会在 Terminal 操作的时候融合起来，一次循环完成。我们可以这样简单的理解，Stream 里有个操作函数的集合，每次转换操作就是把转换函数放入这个集合中，在 Terminal 操作的时候循环 Stream 对应的集合，然后对每个元素执行所有的函数。</p>

<h1 id="stream-的特性可以归纳">Stream 的特性可以归纳</h1>

<ul>
<li>不是数据结构</li>
<li>它没有内部存储，它只是用操作管道从 source（数据结构、数组、generator function、IO channel）抓取数据。</li>
<li><strong>它也绝不修改自己所封装的底层数据结构的数据</strong>。例如 Stream 的 filter 操作会产生一个不包含被过滤元素的新 Stream，而不是从 source 删除那些元素。</li>
<li>所有 Stream 的操作必须以 lambda 表达式为参数</li>
<li>不支持索引访问</li>
<li>很容易生成数组或者 List</li>
<li>Intermediate 操作永远是惰性化的。</li>
<li>并行能力</li>
<li>当一个 Stream 是并行化的，就不需要再写多线程代码，所有对它的操作会自动并行进行的。</li>
<li>可以是无限的</li>
<li>集合有固定大小，Stream 则不必。limit(n) 和 findFirst() 这类的 short-circuiting 操作可以对无限的 Stream 进行运算并很快完成。</li>
</ul>


                
                
<div class="entry-shang text-center">
    
	    <p>「真诚赞赏，手留余香」</p>
	
	<button class="zs show-zs btn btn-bred">赞赏支持</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
	<div class="zs-modal-head">
		<button type="button" class="close">×</button>
		<span class="author"><a href="http://maizitoday.github.io/"><img src="/img/favicon.png" /></a></span>
        
	        <p class="tip"><i></i><span>真诚赞赏，手留余香</span></p>
		
 
	</div>
	<div class="zs-modal-body">
		<div class="zs-modal-btns">
			<button class="btn btn-blink" data-num="2">2元</button>
			<button class="btn btn-blink" data-num="5">5元</button>
			<button class="btn btn-blink" data-num="10">10元</button>
			<button class="btn btn-blink" data-num="50">50元</button>
			<button class="btn btn-blink" data-num="100">100元</button>
			<button class="btn btn-blink" data-num="1">任意金额</button>
		</div>
		<div class="zs-modal-pay">
			<button class="btn btn-bred" id="pay-text">2元</button>
			<p>使用<span id="pay-type">微信</span>扫描二维码完成支付</p>
			<img src="/img/reward/wechat-2.png"  id="pay-image"/>
		</div>
	</div>
	<div class="zs-modal-footer">
		<label><input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked"><span ><span class="zs-wechat"><img src="/img/reward/wechat-btn.png"/></span></label>
		<label><input type="radio" name="zs-type" value="alipay" class="zs-type" class="zs-alipay"><img src="/img/reward/alipay-btn.png"/></span></label>
	</div>
</div>
<script type="text/javascript" src="/js/reward.js"></script>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/java%E5%9F%BA%E7%A1%80-java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88/" data-toggle="tooltip" data-placement="top" title="Java虚拟机到底是什么">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/java%E5%9F%BA%E7%A1%80-jdk1.8%E6%96%B0%E7%89%B9%E6%80%A7-%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8/" data-toggle="tooltip" data-placement="top" title="Jdk1.8新特性-方法引用">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/zookeeper" title="Zookeeper">
                            Zookeeper
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/docker" title="docker">
                            docker
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/dockerfile" title="dockerfile">
                            dockerfile
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/java%E5%9F%BA%E7%A1%80" title="java基础">
                            java基础
                        </a>
                        
                        
                        
                        <a href="/tags/java%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5" title="java相关概念">
                            java相关概念
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/jvm" title="jvm">
                            jvm
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/maven" title="maven">
                            maven
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/springcloud" title="springCloud">
                            springCloud
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/springboot%E7%B3%BB%E5%88%97" title="springboot系列">
                            springboot系列
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/vccode" title="vccode">
                            vccode
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6" title="中间件">
                            中间件
                        </a>
                        
                        
                        
                        <a href="/tags/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6" title="主从复制">
                            主从复制
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E5%88%97" title="分布式系列">
                            分布式系列
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7" title="开发工具">
                            开发工具
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93" title="数据库">
                            数据库
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E6%9C%8D%E5%8A%A1%E8%84%9A%E6%9C%AC" title="服务脚本">
                            服务脚本
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" title="设计模式">
                            设计模式
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1" title="负载均衡">
                            负载均衡
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
                <section>
                    <hr>
                    <h5>FRIENDS</h5>
                    <ul class="list-inline">
                        
                        <li><a target="_blank" href="https://zhaohuabing.com">赵化冰博客</a></li>
                        
                        <li><a target="_blank" href="http://www.tianshouzhi.com">田守枝</a></li>
                        
                        <li><a target="_blank" href="http://www.ityouknow.com">纯洁的微笑</a></li>
                        
                        <li><a target="_blank" href="https://renchunxiao.com">任春晓</a></li>
                        
                        <li><a target="_blank" href="https://www.lihongkun.com">泛泛之辈</a></li>
                        
                        <li><a target="_blank" href="https://juejin.im/welcome/backend">后端服务论坛</a></li>
                        
                        <li><a target="_blank" href="https://www.javaboy.org">江南一点雨</a></li>
                        
                    </ul>
                </section>
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href="" rel="alternate" type="application/rss+xml" title="" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:maiziybtoday@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    <li>
                        <a target="_blank" href="/your%20wechat%20qr%20code%20image">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-wechat fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/yourlinkedinid">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy;  2019
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






</body>
</html>
